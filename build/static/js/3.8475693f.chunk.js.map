{"version":3,"sources":["Components/Chat/Chat.scss","Components/Chat/Messages.scss","Components/Chat/Message.scss","Components/UI/InfiniteProgress/InfiniteProgress.scss","Components/Chat/Loading.scss","Components/UI/TextArea/TextArea.scss","Components/UI/CloseBtn/CloseBtn.scss","Components/Chat/Message.js","Components/UI/InfiniteProgress/InfiniteProgress.js","Components/Chat/Loading.js","Containers/Loading.js","Components/Chat/Messages.js","Containers/Messages.js","Components/UI/TextArea/TextArea.js","Components/UI/CloseBtn/CloseBtn.js","Components/Chat/Chat.js","Containers/Chat.js"],"names":["module","exports","Chat","header","formWrapper","form","textArea","Messages","Message","incomming","outgoing","InfiniteProgress","dot","fillDot","Loading","TextArea","CloseBtn","MessageComponent","style","classnames","styles","this","props","user","id","item","sender_id","react_default","a","createElement","className","message","PureComponent","InfiniteProgress_InfiniteProgress","LoadingContainer","loaded","loading","Loading_Loading","connect","state","chat","MessagesComponent","setRefMessages","ref","_this","messages","onScroll","e","scrollTop","loadMessages","scrollHeight","prevProps","prevStaet","snapshot","Containers_Loading","renderMessages","_this2","map","Message_MessageComponent","key","MessagesContainer","can_load","mounted","Messages_MessagesComponent","dispatch","chatLoad","_ref","onChange","onBlur","onKeyDown","value","link","name","_ref$placeholder","placeholder","Object","assign","c","onClick","ChatComponent","onSend","preventDefault","onSubmit","refMessage","is_private","users","filter","u","join","getTitle","CloseBtn_CloseBtn","onClose","Containers_Messages","TextArea_TextArea","Btn","ChatContainer","history","push","console","log","Chat_ChatComponent","chatMessage"],"mappings":"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","file":"static/js/3.8475693f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Chat\":\"Chat_Chat__2tOF9\",\"header\":\"Chat_header__2PgHf\",\"formWrapper\":\"Chat_formWrapper__OefzX\",\"form\":\"Chat_form__2WpJi\",\"textArea\":\"Chat_textArea__343lG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Messages\":\"Messages_Messages__2gnqT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Message\":\"Message_Message__2Ar8G\",\"incomming\":\"Message_incomming__2Mo1l\",\"outgoing\":\"Message_outgoing__3IgJI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"InfiniteProgress\":\"InfiniteProgress_InfiniteProgress__1eag6\",\"dot\":\"InfiniteProgress_dot__1vD0k\",\"fillDot\":\"InfiniteProgress_fillDot__1AeO9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Loading\":\"Loading_Loading__3RoeH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"TextArea\":\"TextArea_TextArea__pE5GN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"CloseBtn\":\"CloseBtn_CloseBtn__3MTWy\"};","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\n\nimport React, { PureComponent } from 'react'\nimport classnames from 'classnames'\nimport styles from './Message.scss'\n\nexport default class MessageComponent extends PureComponent {\n  render() {\n    const style = classnames(styles.Message, this.props.user.id === this.props.item.sender_id ? styles.outgoing : styles.incomming)\n\n    return (\n      <div className={style}>{this.props.item.message}</div>\n    )\n  }\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React from 'react'\nimport style from './InfiniteProgress.scss'\n\nexport default function InfiniteProgress() {\n  return (\n    <div className={style.InfiniteProgress}>\n      <i className={style.dot}>&nbsp;</i>\n    </div>\n  )\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport InfiniteProgress from '../UI/InfiniteProgress/InfiniteProgress'\nimport styles from './Loading.scss'\n\nexport default class Loading extends PureComponent {\n  render() {\n    return (\n      <div className={styles.Loading}>\n        <InfiniteProgress />\n      </div>\n    )\n  }\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\nimport Loading from '../Components/Chat/Loading'\n\nconst mapStateToProps = state => ({\n  loaded: state.chat.loaded,\n  loading: state.chat.loading\n})\n\nclass LoadingContainer extends PureComponent {\n  render() {\n    if (!(this.props.loaded && this.props.loading)) {\n      return null\n    }\n    return (\n      <Loading />\n    )\n  }\n}\n\nexport default connect(mapStateToProps)(LoadingContainer)\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\n\nimport React, { PureComponent } from 'react'\nimport classnames from 'classnames'\nimport styles from './Messages.scss'\nimport MessageComponent from './Message'\nimport Loading from '../../Containers/Loading'\n\nexport default class MessagesComponent extends PureComponent {\n\n  componentDidMount() {\n    this.messages.scrollTop = this.messages.scrollHeight\n  }\n\n  getSnapshotBeforeUpdate() {\n    return this.messages.scrollHeight - this.messages.scrollTop\n  }\n\n  componentDidUpdate(prevProps, prevStaet, snapshot) {\n    this.messages.scrollTop = this.messages.scrollHeight - snapshot\n  }\n\n  setRefMessages = (ref) => {\n    this.messages = ref\n  }\n\n  onScroll = (e) => {\n    if (this.messages.scrollTop < 100) {\n      this.props.loadMessages()\n    }\n  }\n\n  render() {\n    const style = classnames(styles.Messages, this.props.className)\n    return (\n      <div className={style} ref={this.setRefMessages} onScroll={this.onScroll}>\n        <Loading />\n        {this.renderMessages()}\n      </div>\n    )\n  }\n\n  renderMessages() {\n    return this.props.messages.map(message => (\n      <MessageComponent item={message} user={this.props.user} key={message.id} />))\n  }\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\nimport MessagesComponent from '../Components/Chat/Messages'\nimport { chatLoad } from '../reducers/chat'\n\nconst mapStateToProps = state => ({\n  messages: state.messages,\n  user: state.user,\n  chat: state.chat\n})\n\nconst mapDispatchToProps = dispatch => ({\n  loadMessages() {\n    dispatch(chatLoad())\n  }\n})\n\nclass MessagesContainer extends PureComponent {\n  componentDidMount() {\n    this.mounted = true\n  }\n\n  render() {\n    return (\n      <MessagesComponent\n        className={this.props.className}\n        messages={this.props.messages}\n        user={this.props.user}\n        loadMessages={this.loadMessages}\n      />\n    )\n  }\n\n  loadMessages = () => {\n    if (this.props.chat.can_load && !this.props.chat.loading && this.mounted) {\n      this.props.loadMessages()\n    }\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessagesContainer)\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\n\nimport React from 'react'\nimport PropTypes from 'prop-types'\n\nimport style from './TextArea.scss'\n\nexport default function TextArea({ onChange, onBlur, onKeyDown, value, link, name, placeholder = '' }) {\n  return (\n    <textarea\n      className={style.TextArea}\n      ref={c => (link && link(c))}\n      {...{ name, value, placeholder, onChange, onBlur, onKeyDown }}\n    />\n  )\n}\n\nTextArea.propTypes = {\n  name: PropTypes.string.isRequired,\n  onChange: PropTypes.func,\n  onBlur: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  value: PropTypes.string,\n  placeholder: PropTypes.string,\n  link: PropTypes.func,\n  type: PropTypes.string\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React from 'react'\nimport styles from './CloseBtn.scss'\n\nexport default function CloseBtn({ onClick }) {\n  return (\n    <button className={styles.CloseBtn} onClick={onClick}></button>\n  )\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport styles from './Chat.scss'\nimport MessagesContainer from '../../Containers/Messages'\nimport TextArea from '../UI/TextArea/TextArea'\nimport Btn from '../UI/Btn/Btn'\nimport CloseBtn from '../UI/CloseBtn/CloseBtn'\n\nexport default class ChatComponent extends PureComponent {\n  getTitle() {\n    if (!this.props.chat.is_private) {\n      return this.props.chat.name\n    }\n\n    return this.props.chat.users.filter(u => u.id !== this.props.user.id).map(u => u.name).join(', ')\n  }\n\n  onSend = (e) => {\n    e.preventDefault()\n    this.props.onSubmit(this.message.value)\n    this.message.value = ''\n  }\n\n  refMessage = (ref) => {\n    this.message = ref\n  }\n\n  render() {\n    return (\n      <div className={styles.Chat}>\n        <div className={styles.header}>\n          <div>{this.getTitle()}</div>\n          <CloseBtn onClick={this.props.onClose} />\n        </div>\n        <MessagesContainer className={styles.messages} />\n        <div className={styles.formWrapper}>\n          <form className={styles.form} onSubmit={this.onSend}>\n            <TextArea name=\"message\" className={styles.textArea} link={this.refMessage} />\n            <Btn onClick={this.onSend}>Отправить</Btn>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\nimport ChatComponent from '../Components/Chat/Chat'\nimport { chatMessage } from '../reducers/chat'\n\nconst mapStateToProps = state => ({\n  user: state.user,\n  chat: state.chat\n})\n\nconst mapDispatchToProps = dispatch => ({\n  onSubmit(message) {\n    dispatch(chatMessage(message))\n  }\n})\n\nclass ChatContainer extends PureComponent {\n  render() {\n    console.log(this.props);\n    return (\n      <ChatComponent\n        user={this.props.user}\n        chat={this.props.chat}\n        onSubmit={this.props.onSubmit}\n        onClose={this.onClose}\n      />\n    )\n  }\n\n  onClose = () => {\n    this.props.history.push('/chats')\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatContainer)\n"],"sourceRoot":""}