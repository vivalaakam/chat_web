{"version":3,"sources":["registerServiceWorker.js","index.js","utils/PushManager.js","api/subscription.js","reducers/user.js","reducers/messages.js","utils/date.js","reducers/chat.js","utils/token.js","api/rest.js","api/chats.js","Components/UI/Btn/Btn.scss","Components/Modal/Modal.scss","Components/UI/Btn/Btn.js","utils/history.js","utils/helpers.js","Wrapper.js","Loading.js","reducers/outer.js","api/users.js","reducers/users.js","reducers/chats.js","reducers/sagas.js","reducers/store.js","Components/Modal/Modal.js","Components/Auth/Auth.js","utils/loginPopup.js","Containers/Auth.js","Containers/Home.js","Containers/Terms.js","App.js","reducers/index.js","Components/Auth/Auth.scss"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","ReactDOM","render","react_default","a","createElement","App","document","getElementById","URL","process","origin","addEventListener","concat","fetch","response","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","subscriptionApi","Subscription","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","Rest","urlB64ToUint8Array","base64String","base64","repeat","length","replace","rawData","atob","outputArray","Uint8Array","i","charCodeAt","PushManager","run","pushManager","getSubscription","subscription","hasSubscription","_context","t0","subscribe","userVisibleOnly","applicationServerKey","create","JSON","stringify","source","resp","_context2","t1","unsubscribe","single","userApplyAction","watcher","$$initialState","loaded","USER_UPDATE","USER_APPLY","user","$$state","arguments","undefined","_ref","type","payload","objectSpread","userUpdate","createAction","userApply","_ref2","regenerator_default","wrap","prev","next","token","setToken","subscribeUser","sent","localStorage","setItem","data","id","put","message","stop","_marked","getUser","fork","takeLatest","_marked2","MESSAGES_UPDATE","MESSAGES_RESET","prepareMessages","messages","map","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","inserted_at","Date","sorted","sort","b","shift","curr","res","in_block","sender_id","push","getMessages","messagesUpdate","messagesReset","getCurrentDateTime","date","tzoffset","getTimezoneOffset","toISOString","slice","onChatInit","chatSubscribe","onChatMessage","onChatLoad","onChatUnmount","loading","can_load","chatsAPI","Chats","CHAT_INIT","CHAT_LOAD","CHAT_RESET","CHAT_UPDATE","CHAT_UNMOUNT","CHAT_MESSAGE","chat","chatSubscription","chatLoad","chatReset","chatUpdate","chatMessage","getChat","cancel","select","chatId","guardian_token","eventChannel","emitter","socket","Socket","params","connect","chan","channel","join","on","disconnect","take","last_message","close","finish","_ref3","_chat","_context3","trim","_marked3","_chat2","msgs","last","_context4","_marked4","_context5","_marked5","_context6","_marked6","KEY","__webpack_exports__","getToken","getItem","jwt","cookie","removeToken","url","_this","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__","getUrl","subpath","base_url","postQuery","putQuery","getQuery","deleteQuery","options","afterQuery","json","method","body","Authorization","Content-Type","mode","credentials","Error","ok","handleError","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","queryString","module","exports","Btn","defaultScheme","active","inverted","blueScheme","greenScheme","orangeScheme","githubScheme","googleScheme","facebookScheme","Modal","wrapper","_classnames","children","className","onClick","name","disabled","scheme","cName","classnames","style","_Users_user_work_chat_web_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","assign","defaultProps","hasWindow","createHistory","Wrapper","store","history","es","react_router_redux_es","Loading","UPDATE_STATE","outer","reducer","action","updateState","Users","full","users","string","arrayFormat","onUsersInit","onUsersPrivateChat","userApi","chatApi","USERS_UPDATE","USERS_RESET","USERS_PRIVATE_CHAT","USERS_INIT","usersReset","_user","all","filter","u","_user2","is_private","onChatsUpdate","chatsApi","CHATS_UPDATE","CHATS_RESET","c","chats","item","tmp","reduce","defineProperty","values","chatsReset","_chats","chats_marked","chats_marked2","rootSaga","routes","/chats/:chatId","mark","chatsChatId","sagas","chatWatcher","userWatcher","chatsWatcher","usersWatcher","unshift","router","sagas_marked","sagaMiddleware","createSagaMiddleware","middleware","thunk","modalRoot","props","el","appendChild","removeChild","createPortal","renderWrapper","styles","PureComponent","Auth","e","provider","preventDefault","Promise","resolve","win","curWidth","offsetWidth","leftPos","screenLeft","topPos","screenTop","result","features","open","applyAuth","Modal_Modal_Modal","Auth_Auth_Auth","dispatch","HomeContainer","Redirect","to","TermsContainer","loadableFactory","loader","Loadable","Comp","default","__webpack_require__","bind","userStore","initialState","middle","require","routerMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","ext","combineReducers","routing","createReducers","applyMiddleware","apply","toConsumableArray","persistState","filtered","keys","getState","st","key","prototype","hasOwnProperty","runSaga","asyncReducers","configureStore","__INITIAL_STATE__","Containers_Auth","Switch","Route","exact","path","component","Home","Terms","Component"],"mappings":"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","file":"static/js/main.76592832.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n","/**\n * Created by vivalaakam on 17.01.2019.\n *\n * @flow\n */\nimport Subscription from '../api/subscription'\n\nconst subscriptionApi = new Subscription()\n\nfunction urlB64ToUint8Array(base64String) {\n  const padding = '='.repeat((4 - base64String.length % 4) % 4)\n  const base64 = (base64String + padding)\n    .replace(/\\-/g, '+')\n    .replace(/_/g, '/')\n\n  const rawData = window.atob(base64)\n  const outputArray = new Uint8Array(rawData.length)\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i)\n  }\n  return outputArray\n}\n\nexport default class PushManager {\n  static single = new PushManager()\n\n  constructor() {\n    if (typeof navigator !== 'undefined' && typeof window !== 'undefined' && 'serviceWorker' in navigator && 'PushManager' in window) {\n      this.run()\n    }\n  }\n\n  async run() {\n    try {\n      this.serviceWorker = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/push-worker.js`)\n      const subscription = await this.serviceWorker.pushManager.getSubscription()\n\n      this.hasSubscription = !(subscription === null)\n    } catch (e) {\n      console.error('Service Worker Error', e)\n    }\n  }\n\n  async subscribeUser() {\n    if (!this.serviceWorker) {\n      return\n    }\n    try {\n      const subscription = await this.serviceWorker.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: urlB64ToUint8Array(process.env.VAPID_PUBLIC_KEY)\n      })\n\n      try {\n        const resp = await subscriptionApi.create({\n          subscription: {\n            subscription: JSON.stringify(subscription),\n            source: 'web'\n          }\n        })\n        this.hasSubscription = true\n        return resp\n      } catch (e) {\n        this.hasSubscription = false\n      }\n    } catch (err) {\n      console.log('Failed to subscribe the user: ', err)\n    }\n  }\n\n  async unsubscribeUser() {\n    if (!this.serviceWorker) {\n      return\n    }\n\n    const subscription = await this.serviceWorker.pushManager.getSubscription()\n    if (subscription) {\n      this.hasSubscription = false\n      return subscription.unsubscribe()\n    }\n\n    return false\n\n  }\n}\n\n","/**\n * Created by vivalaakam on 17.01.2019.\n *\n * @flow\n */\nimport Rest from './rest'\n\nexport default class Subscription extends Rest {\n  constructor() {\n    super('api/subscription')\n  }\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport { createAction } from 'redux-actions'\nimport { fork, put, takeLatest } from 'redux-saga/effects'\nimport token from '../utils/token'\nimport PushManager from '../utils/PushManager'\n\nconst $$initialState = {\n  loaded: false\n}\n\nexport const USER_UPDATE = 'USER_UPDATE'\nconst USER_APPLY = 'USER_APPLY'\n\n\nexport default function user($$state = $$initialState, { type, payload }) {\n  switch (type) {\n    case USER_UPDATE:\n      return {\n        ...$$state,\n        ...payload\n      }\n    default:\n      return $$state\n  }\n}\n\nexport const userUpdate = createAction(USER_UPDATE)\nexport const userApply = createAction(USER_APPLY)\n\nfunction* userApplyAction({ payload }) {\n  try {\n    token.setToken(payload.token)\n\n    const subscription = yield PushManager.single.subscribeUser()\n\n    if (subscription) {\n      localStorage.setItem('subscription', subscription.data.id)\n    }\n    yield put(userUpdate(payload))\n  } catch (e) {\n    console.log('userApplyAction', e.message)\n  }\n}\n\nexport function getUser(state) {\n  return state.user\n}\n\nexport function* watcher() {\n  yield fork(takeLatest, USER_APPLY, userApplyAction)\n}\n","/**\n * Created by vivalaakam on 07.05.2018.\n *\n * @flow\n */\n\nimport { createAction } from 'redux-actions'\n\nconst $$initialState = []\n\nconst MESSAGES_UPDATE = 'MESSAGES_UPDATE'\nconst MESSAGES_RESET = 'MESSAGES_RESET'\n\nfunction prepareMessages($$state, payload) {\n  if (payload.length === 0) {\n    return $$state\n  }\n\n  const messages = payload.map(message => ({\n    ...message,\n    inserted_at: new Date(message.inserted_at)\n  }))\n  const sorted = $$state.concat(messages).sort((a, b) => a.inserted_at - b.inserted_at)\n\n  let prev = sorted.shift()\n  let curr = sorted.shift()\n\n  const res = [prev]\n\n  while (sorted.length) {\n    curr.in_block = prev.sender_id === curr.sender_id\n    res.push(curr)\n    prev = curr\n    curr = sorted.shift()\n  }\n  if (!!curr) {\n    res.push(curr)\n  }\n  return res\n}\n\nexport default function messages($$state = $$initialState, { type, payload }) {\n  switch (type) {\n    case MESSAGES_RESET: {\n      return prepareMessages($$initialState, payload)\n    }\n    case MESSAGES_UPDATE: {\n      return prepareMessages($$state, payload)\n    }\n    default:\n      return $$state\n  }\n}\n\nexport const getMessages = state => state.messages\n\nexport const messagesUpdate = createAction(MESSAGES_UPDATE)\nexport const messagesReset = createAction(MESSAGES_RESET)\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\nexport function getCurrentDateTime(date) {\n  var tzoffset = (date).getTimezoneOffset() * 60000 //offset in milliseconds\n  var localISOTime = (new Date(date - tzoffset)).toISOString().slice(0, 19).replace('T', ' ')\n  var mySqlDT = localISOTime\n  return mySqlDT\n}\n","/**\n * Created by vivalaakam on 07.05.2018.\n *\n * @flow\n */\nimport { Socket } from 'phoenix'\nimport { eventChannel } from 'redux-saga'\nimport { createAction } from 'redux-actions'\nimport { cancel, fork, put, select, take, takeLatest } from 'redux-saga/effects'\nimport Chats from '../api/chats'\nimport { getMessages, messagesReset, messagesUpdate } from './messages'\nimport { getUser } from './user'\nimport { getCurrentDateTime } from '../utils/date'\n\nconst $$initialState = {\n  loaded: false,\n  loading: false,\n  can_load: true\n}\n\nconst chatsAPI = new Chats()\n\nexport const CHAT_INIT = 'CHAT_INIT'\nexport const CHAT_LOAD = 'CHAT_LOAD'\nexport const CHAT_RESET = 'CHAT_RESET'\nexport const CHAT_UPDATE = 'CHAT_UPDATE'\nexport const CHAT_UNMOUNT = 'CHAT_UNMOUNT'\nexport const CHAT_MESSAGE = 'CHAT_MESSAGE'\n\nexport default function chat($$state = $$initialState, { type, payload }) {\n  switch (type) {\n    case CHAT_RESET:\n      return {\n        ...$$initialState,\n        ...payload\n      }\n    case CHAT_UPDATE:\n      return {\n        ...$$state,\n        ...payload\n      }\n    default:\n      return $$state\n  }\n}\n\nexport const chatInit = createAction(CHAT_INIT)\nexport const chatLoad = createAction(CHAT_LOAD)\nexport const chatReset = createAction(CHAT_RESET)\nexport const chatUpdate = createAction(CHAT_UPDATE)\nexport const chatUnmount = createAction(CHAT_UNMOUNT)\nexport const chatMessage = createAction(CHAT_MESSAGE)\n\nexport const getChat = state => state.chat\n\nlet chatSubscription\n\nexport function* onChatInit({ payload }) {\n  try {\n    if (chatSubscription) {\n      yield cancel(chatSubscription)\n    }\n    const resp = yield chatsAPI.fetch(payload)\n    yield put(chatUpdate({ ...resp.data, can_load: resp.data.messages.length === 25 }))\n    yield put(messagesReset(resp.data.messages))\n\n    const user = yield select(getUser)\n    chatSubscription = yield fork(chatSubscribe, resp.data.id, user.token)\n  } catch (e) {\n    console.log('onChatInit', e.message)\n  }\n}\n\n\nfunction* chatSubscribe(chatId, guardian_token) {\n  let subscription\n  try {\n\n    subscription = eventChannel((emitter) => {\n      const socket = new Socket(`${process.env.PROXY_SERVER.replace(/^http/, 'ws')}/socket`, {\n        params: { guardian_token }\n      })\n\n      socket.connect()\n\n      const chan = socket.channel(`chat:${chatId}`, {})\n      chan.join()\n      chan.on('on_message', emitter)\n\n      return () => {\n        socket.disconnect()\n      }\n    })\n\n    while (true) {\n      const data = yield take(subscription)\n      yield put(messagesUpdate([data]))\n      yield put(chatUpdate({ last_message: data }))\n    }\n\n  } catch (e) {\n    console.log('chatSubscribe', e.message)\n  } finally {\n    if (subscription.close) {\n      subscription.close()\n    }\n  }\n}\n\nfunction* onChatMessage({ payload }) {\n  try {\n    const chat = yield select(getChat)\n    yield chatsAPI.message(chat.id, payload.trim())\n  } catch (e) {\n    console.log('onChatMessage', e.message)\n  }\n}\n\nfunction* onChatLoad() {\n  try {\n    yield put(chatUpdate({ loading: true }))\n    const chat = yield select(getChat)\n    const msgs = yield select(getMessages)\n    const last = msgs[0]\n    const messages = yield chatsAPI.messages(chat.id, getCurrentDateTime(last.inserted_at))\n    yield put(chatUpdate({ loading: false, can_load: messages.data.length === 25, loaded: true }))\n    yield put(messagesUpdate(messages.data))\n  } catch (e) {\n    console.log('onChatLoad', e.message)\n  }\n}\n\nfunction* onChatUnmount() {\n  try {\n    yield put(chatReset({}))\n    yield put(messagesReset([]))\n    if (chatSubscription) {\n      yield cancel(chatSubscription)\n    }\n  } catch (e) {\n    console.log('onChatUnmount', e.message)\n  }\n}\n\nexport function* watcher() {\n  yield fork(takeLatest, CHAT_INIT, onChatInit)\n  yield fork(takeLatest, CHAT_LOAD, onChatLoad)\n  yield fork(takeLatest, CHAT_UNMOUNT, onChatUnmount)\n  yield fork(takeLatest, CHAT_MESSAGE, onChatMessage)\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nconst KEY = 'jwtToken'\n\nexport default {\n  getToken() {\n    return typeof localStorage !== 'undefined' && localStorage.getItem(KEY)\n  },\n  setToken(jwt) {\n    if (jwt) {\n      localStorage.setItem(KEY, jwt)\n      document.cookie = `Authorization=Bearer ${jwt}`\n    }\n  },\n  removeToken() {\n    localStorage.setItem(KEY, null)\n    document.cookie = 'Authorization='\n  }\n}\n","/**\n * Created by vivalaakam on 04.05.2018.\n *\n * @flow\n */\n\nimport token from '../utils/token'\n\nexport default class Rest {\n  url = process.env.PROXY_SERVER\n\n  constructor(url) {\n    this.base_url = url\n  }\n\n  getUrl = (subpath = '', params = null) => {\n    if (!params) {\n      return `${this.url}/${this.base_url}${subpath}`\n    }\n\n    return `${this.url}/${this.base_url}${subpath}?${params}`\n  }\n\n  create(data) {\n    return this.postQuery(`${this.getUrl()}`, data)\n  }\n\n  update(id, data) {\n    return this.putQuery(`${this.getUrl()}/${id}`, data)\n  }\n\n  fetch(id) {\n    return this.getQuery(`${this.getUrl()}/${id}`)\n  }\n\n  all() {\n    return this.getQuery(`${this.getUrl()}`)\n  }\n\n  remove(id) {\n    return this.deleteQuery(`${this.getUrl()}/${id}`)\n  }\n\n  async getQuery(url) {\n    const jwt = token.getToken()\n    const resp = await fetch(url, this.options(jwt))\n    const response = Rest.afterQuery(resp)\n    return response.json()\n  }\n\n  async postQuery(url, data) {\n    const jwt = token.getToken()\n\n    const resp = await fetch(url, this.options(jwt, {\n      method: 'POST',\n      body: JSON.stringify(data)\n    }))\n    const response = Rest.afterQuery(resp)\n    return response.json()\n  }\n\n  async putQuery(url, data) {\n    const jwt = token.getToken()\n\n    const resp = await fetch(url, this.options(jwt, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    }))\n    const response = Rest.afterQuery(resp)\n    return response.json()\n  }\n\n  async deleteQuery(url) {\n    const jwt = token.getToken()\n\n    const resp = await fetch(url, this.options(jwt, {\n      method: 'DELETE'\n    }))\n    const response = Rest.afterQuery(resp)\n    return true\n  }\n\n  static async handleError(response) {\n    const resp = await response.json()\n    throw new Error(resp.message)\n  }\n\n  static afterQuery(response) {\n    if (!response.ok) {\n      return Rest.handleError(response)\n    }\n\n    return response\n  }\n\n  options(token, params = {}) {\n    const headers = {\n      Authorization: `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    }\n\n    return {\n      headers,\n      mode: 'cors',\n      credentials: 'include',\n      ...params\n    }\n  }\n}\n","/**\n * Created by vivalaakam on 07.05.2018.\n *\n * @flow\n */\nimport Rest from './rest'\nimport queryString from 'query-string'\n\nexport default class Chats extends Rest {\n  constructor() {\n    super('api/chats')\n  }\n\n  messages(id, last_message = null) {\n    return this.getQuery(this.getUrl(`/${id}/messages`, queryString.stringify({ last_message })))\n  }\n\n  message(id, message) {\n    return this.postQuery(`${this.getUrl()}/${id}/message`, { message: { message } })\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Btn\":\"Btn_Btn___6Qbu\",\"defaultScheme\":\"Btn_defaultScheme__2FZxQ\",\"active\":\"Btn_active__1sQMl\",\"inverted\":\"Btn_inverted__3hx0f\",\"blueScheme\":\"Btn_blueScheme__1HpUY\",\"greenScheme\":\"Btn_greenScheme__2wwnR\",\"orangeScheme\":\"Btn_orangeScheme__eglMg\",\"githubScheme\":\"Btn_githubScheme__3P5DQ\",\"googleScheme\":\"Btn_googleScheme__gelXl\",\"facebookScheme\":\"Btn_facebookScheme__3T4xQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Modal\":\"Modal_Modal__2Ff3a\",\"wrapper\":\"Modal_wrapper__17Z-7\"};","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport classnames from 'classnames'\nimport style from './Btn.scss'\n\nexport default function Btn({ children, className, onClick, name, active, inverted, disabled, scheme }) {\n  const cName = classnames(style.Btn, style[`${scheme}Scheme`], className, {\n    [style.active]: active,\n    [style.inverted]: inverted\n  })\n  return (\n    <button className={cName} {...{ name, disabled, onClick }}>{children}</button>\n  )\n}\n\nBtn.propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n    PropTypes.element\n  ]).isRequired,\n  name: PropTypes.string,\n  className: PropTypes.string,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool,\n  disabled: PropTypes.bool,\n  inverted: PropTypes.bool,\n  scheme: PropTypes.oneOf(['default', 'green', 'blue', 'orange', 'github', 'google', 'facebook'])\n}\n\nBtn.defaultProps = {\n  scheme: 'default',\n  name: '',\n  className: '',\n  disabled: false,\n  inverted: false,\n  active: false\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport createHistory from 'history/createBrowserHistory'\nimport { hasWindow } from './helpers'\n\nexport default hasWindow && createHistory()\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nexport const hasWindow = typeof window !== 'undefined'\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\nimport React from 'react'\nimport { Provider } from 'react-redux'\nimport { ConnectedRouter } from 'react-router-redux'\nimport history from './utils/history'\n\nexport default function Wrapper({ store, children }) {\n  if (history) {\n    return (\n      <Provider store={store}>\n        <ConnectedRouter history={history} store={store}>\n          {children}\n        </ConnectedRouter>\n      </Provider>\n    )\n  }\n\n  return (\n    <Provider store={store}>\n      {children}\n    </Provider>\n  )\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\nimport React from 'react'\n\nconst Loading = () => (\n  <div>Loading</div>\n)\n\nexport default Loading\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport { createAction } from 'redux-actions'\n\nconst UPDATE_STATE = 'UPDATE_STATE'\n\nexport default function outer(reducer) {\n  return function outerReducer(state, action) {\n    switch (action.type) {\n      case UPDATE_STATE:\n        return reducer({ ...state, ...action.payload }, action)\n      default:\n        return reducer(state, action)\n    }\n  }\n}\n\nexport const updateState = createAction(UPDATE_STATE)\n","/**\n * Created by vivalaakam on 04.05.2018.\n *\n * @flow\n */\nimport queryString from 'query-string';\nimport Rest from './rest';\n\nexport default class Users extends Rest {\n  constructor() {\n    super('api/users');\n  }\n\n  update(data) {\n    return this.postQuery(this.getUrl(), data);\n  }\n\n  fetch(full = false) {\n    return this.getQuery(this.getUrl('', queryString.stringify({ full })));\n  }\n\n  list(users = []) {\n    const string = queryString.stringify({ users }, { arrayFormat: 'bracket' });\n    return this.getQuery(this.getUrl('/list', string));\n  }\n}\n","/**\n * Created by vivalaakam on 08.05.2018.\n *\n * @flow\n */\n\nimport { createAction } from 'redux-actions'\nimport { fork, put, select, takeLatest } from 'redux-saga/effects'\nimport Users from '../api/users'\nimport { getUser } from './user'\nimport Chats from '../api/chats'\nimport { chatUpdate } from './chat'\n\nconst userApi = new Users()\nconst chatApi = new Chats()\nconst $$initialState = []\n\nexport const USERS_UPDATE = 'USERS_UPDATE'\nexport const USERS_FETCH = 'USERS_FETCH'\nexport const USERS_RESET = 'USERS_RESET'\nexport const USERS_PRIVATE_CHAT = 'USERS_PRIVATE_CHAT'\nexport const USERS_INIT = 'USERS_INIT'\n\nexport default function user($$state = $$initialState, { type, payload }) {\n  switch (type) {\n    case USERS_RESET:\n      return payload\n    case USERS_UPDATE:\n      return $$state.concat(payload)\n    default:\n      return $$state\n  }\n}\n\nexport const usersUpdate = createAction(USERS_UPDATE)\nexport const usersReset = createAction(USERS_RESET)\nexport const usersFetch = createAction(USERS_FETCH)\nexport const usersPrivateChat = createAction(USERS_PRIVATE_CHAT)\nexport const usersInit = createAction(USERS_INIT)\n\nfunction* onUsersInit() {\n  try {\n    const user = yield select(getUser)\n    const users = yield userApi.all()\n    const data = users.data.filter((u) => (u.id !== user.id))\n    yield put(usersReset(data))\n  } catch (e) {\n    console.log('onUsersInit', e.message)\n  }\n}\n\nfunction* onUsersPrivateChat({ payload }) {\n  try {\n    const user = yield select(getUser)\n    const chat = yield chatApi.create({ chat: { name: 'private', is_private: true, users: [payload.id, user.id] } })\n    yield put(chatUpdate(chat.data))\n  } catch (e) {\n    console.log('onUsersPrivateChat', e.message)\n  }\n}\n\nexport function* watcher() {\n  yield fork(takeLatest, USERS_INIT, onUsersInit)\n  yield fork(takeLatest, USERS_PRIVATE_CHAT, onUsersPrivateChat)\n}\n","/**\n * Created by vivalaakam on 20.06.2018.\n *\n * @flow\n */\n\nimport { fork, put, select, takeLatest } from 'redux-saga/effects'\nimport { createAction } from 'redux-actions'\nimport { getUser, USER_UPDATE } from './user'\nimport Chats from '../api/chats'\n\nconst chatsApi = new Chats()\n\nconst $$initialState = []\n\nconst CHATS_UPDATE = 'CHATS_UPDATE'\nconst CHATS_RESET = 'CHATS_RESET'\n\nfunction replace($$state, item) {\n  const tmp = $$state.reduce((state, chat) => ({ ...state, [chat.id]: chat }), {})\n\n  tmp[item.id] = item\n\n  return sort(Object.values(tmp))\n}\n\nfunction sort($$state) {\n  return $$state\n    .map(c => ({\n      ...c,\n      last: c.last || new Date((c.last_message && c.last_message.inserted_at) || c.inserted_at)\n    }))\n    .sort((a, b) => b.last - a.last)\n}\n\nexport default function chats($$state = $$initialState, { type, payload }) {\n  switch (type) {\n    case CHATS_UPDATE:\n      return replace($$state, payload)\n    case CHATS_RESET:\n      return sort(payload)\n    default:\n      return $$state\n  }\n}\n\nexport const chatsReset = createAction(CHATS_RESET)\nexport const chatsUpdate = createAction(CHATS_UPDATE)\n\nfunction* onChatsUpdate() {\n  try {\n    const { token } = yield select(getUser)\n    if (token) {\n      const chats = yield chatsApi.all()\n      yield put(chatsReset(chats.data))\n    } else {\n      yield put(chatsReset([]))\n    }\n  } catch (e) {\n    console.log('init', e.message)\n  }\n}\n\nexport function* watcher() {\n  yield fork(onChatsUpdate)\n  yield fork(takeLatest, USER_UPDATE, onChatsUpdate)\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport { all, call, fork } from 'redux-saga/effects'\nimport { router } from 'redux-saga-router'\nimport history from '../utils/history'\n\nimport { onChatInit, watcher as chatWatcher } from './chat'\nimport { watcher as userWatcher } from './user'\nimport { watcher as chatsWatcher } from './chats'\nimport { watcher as usersWatcher } from './users'\n\nconst routes = {\n  * '/chats/:chatId'({ chatId }) {\n    yield call(onChatInit, { payload: chatId })\n  }\n}\n\nexport default function* rootSaga() {\n  const sagas = [\n    chatWatcher(),\n    userWatcher(),\n    chatsWatcher(),\n    usersWatcher()\n  ]\n\n  if (history) {\n    sagas.unshift(router(history, routes))\n  }\n\n  yield fork(all, sagas)\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport { applyMiddleware, compose, createStore } from 'redux'\nimport thunk from 'redux-thunk'\nimport createSagaMiddleware from 'redux-saga'\nimport { updateState } from '../reducers/outer'\nimport createReducers from './index'\nimport { hasWindow } from '../utils/helpers'\nimport history from '../utils/history'\nimport sagas from './sagas'\nimport persistState from 'redux-localstorage'\n\nconst sagaMiddleware = createSagaMiddleware()\n\n\nconst middleware = [\n  thunk,\n  sagaMiddleware,\n]\n\nif (process.env.NODE_ENV === 'development' && hasWindow) {\n  const { createLogger } = require('redux-logger')\n\n  const logger = createLogger({\n    actionTransformer: action => ({\n      ...action,\n      type: String(action.type)\n    })\n  })\n\n\n  middleware.push(logger)\n}\n\nexport default function configureStore(initialState) {\n  const middle = [...middleware]\n  if (history) {\n    const router = require('react-router-redux')\n    middle.push(router.routerMiddleware(history))\n  }\n\n  const composeEnhancers = (window && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) || compose\n\n  const store = createStore(\n    createReducers(),\n    {},\n    composeEnhancers(applyMiddleware(...middle), persistState(['user']))\n  )\n\n  store.updateState = (state) => {\n    const keys = Object.keys(store.getState())\n    const filtered = keys.reduce((st, key) => {\n      if (Object.prototype.hasOwnProperty.call(state, key)) {\n        st[key] = state[key]\n      }\n      return st\n    }, {})\n\n    return store.dispatch(updateState(filtered))\n  }\n  store.runSaga = sagaMiddleware.run\n  store.asyncReducers = {}\n\n  store.updateState(initialState)\n\n  /* istanbul ignore next */\n  if (module.hot) {\n    module.hot.accept('./index', () => {\n      import('./index').then((reducerModule) => {\n        const createReducersLoaded = reducerModule.default\n        const nextReducers = createReducersLoaded({ ...store.asyncReducers })\n\n        store.replaceReducer(nextReducers)\n      })\n    })\n  }\n\n  sagaMiddleware.run(sagas)\n\n  return store\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport ReactDOM from 'react-dom'\nimport classnames from 'classnames'\nimport styles from './Modal.scss'\n\nconst modalRoot = document.getElementById('modal')\n\nexport default class Modal extends PureComponent {\n  constructor(props) {\n    super(props)\n    this.el = document.createElement('div')\n  }\n\n  componentDidMount() {\n    // The portal element is inserted in the DOM tree after\n    // the Modal's children are mounted, meaning that children\n    // will be mounted on a detached DOM node. If a child\n    // component requires to be attached to the DOM tree\n    // immediately when mounted, for example to measure a\n    // DOM node, or uses 'autoFocus' in a descendant, add\n    // state to Modal and only render the children when Modal\n    // is inserted in the DOM tree.\n    modalRoot.appendChild(this.el)\n  }\n\n  componentWillUnmount() {\n    modalRoot.removeChild(this.el)\n  }\n\n  render() {\n    return ReactDOM.createPortal(\n      this.renderWrapper(),\n      this.el\n    )\n  }\n\n  renderWrapper() {\n    const style = classnames(styles.wrapper, this.props.className)\n    return (\n      <div className={styles.Modal}>\n        <div className={style}>\n          {this.props.children}\n        </div>\n      </div>\n    )\n  }\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\nimport React, { PureComponent } from 'react'\nimport Modal from '../Modal/Modal'\n\nimport styles from './Auth.scss'\nimport Btn from '../UI/Btn/Btn'\nimport loginPopup from '../../utils/loginPopup'\n\nexport default class Auth extends PureComponent {\n  render() {\n    return (\n      <Modal className={styles.Auth}>\n        <Btn onClick={this.onClick} scheme=\"facebook\">\n          Login with Facebook\n        </Btn>\n      </Modal>\n    )\n  }\n\n  onClick = (e) => {\n    if (e) {\n      e.preventDefault()\n    }\n    loginPopup('facebook')\n      .then((data) => {\n        this.props.applyAuth(data)\n      })\n      .catch((error) => {\n        /* eslint no-console: [\"error\", { allow: [\"log\"] }] */\n        console.log(error.message)\n      })\n  }\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nexport default function loginPopup(provider) {\n  return new Promise((resolve) => {\n    let win\n    const curWidth = document.body.offsetWidth\n    const curLeft = window.screenLeft\n    const leftPos = curLeft + (curWidth / 2) - 500\n\n    const curTop = window.screenTop\n    const topPos = curTop + 100\n\n    function receiveMessage(result) {\n      if (result.data.id) {\n        resolve(result.data)\n        win.close()\n      }\n    }\n\n    window.addEventListener('message', receiveMessage, false)\n    const features = `status=no,scrollbar=yes,resizable=yes,width=1000,height=600,top=${topPos},left=${leftPos}`\n    console.log(`${process.env.PROXY_SERVER}/auth/${provider}`);\n    win = window.open(`${process.env.PROXY_SERVER}/auth/${provider}`, 'auth_popup', features)\n  })\n}\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\n\nimport AuthComponent from '../Components/Auth/Auth'\nimport { userApply } from '../reducers/user'\n\nconst mapStateToProps = state => ({\n  user: state.user\n})\n\nconst mapDispathToProps = dispatch => ({\n  applyAuth(data) {\n    dispatch(userApply(data))\n  }\n})\n\nclass Auth extends PureComponent {\n  render() {\n    if (this.props.user.id) {\n      return null\n    }\n\n    return (\n      <AuthComponent applyAuth={this.props.applyAuth} />\n    )\n  }\n}\n\nexport default connect(mapStateToProps, mapDispathToProps)(Auth)\n","/**\n * Created by vivalaakam on 18.01.2019.\n *\n * @flow\n */\n\nimport React, { PureComponent } from 'react'\nimport { Redirect } from 'react-router-dom'\n\nclass HomeContainer extends PureComponent {\n  render() {\n    return (\n      <Redirect to=\"/chats\" />\n    )\n  }\n}\n\n\nexport default HomeContainer\n","/**\n * Created by vivalaakam on 18.01.2019.\n *\n * @flow\n */\n\nimport React, { PureComponent } from 'react'\n\nclass TermsContainer extends PureComponent {\n  render() {\n    return (\n      <p>Используйте приложение на свой страх и риск</p>\n    )\n  }\n}\n\n\nexport default TermsContainer\n","import React, { Component } from 'react'\nimport { Route, Switch } from 'react-router-dom'\nimport Loadable from 'react-loadable'\n\nimport Wrapper from './Wrapper'\nimport Loading from './Loading'\nimport configureStore from './reducers/store'\nimport Auth from './Containers/Auth'\nimport Home from './Containers/Home'\nimport Terms from './Containers/Terms'\n\nexport function loadableFactory(loader) {\n  return Loadable({\n    loader,\n    loading: Loading,\n    render(loaded, props) {\n      const Comp = loaded.default\n      return <Comp {...props} />\n    }\n  })\n}\n\nconst Chats = loadableFactory(() => import('./Containers/Chats'))\n\nconst userStore = configureStore(window.__INITIAL_STATE__ || {})\n\nclass App extends Component {\n  render() {\n    return (\n      <Wrapper store={userStore}>\n        <div id=\"inner\">\n          <Auth />\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n            <Route path=\"/chats\" component={Chats} />\n            <Route path=\"/terms\" component={Terms} />\n          </Switch>\n        </div>\n      </Wrapper>\n    )\n  }\n}\n\nexport default App\n","/**\n * Created by vivalaakam on 19.06.2018.\n *\n * @flow\n */\n\nimport { combineReducers } from 'redux'\nimport { routerReducer as routing } from 'react-router-redux'\n\nimport messages from './messages'\nimport outer from './outer'\nimport users from './users'\nimport chats from './chats'\nimport user from './user'\nimport chat from './chat'\n\nexport default function reducers(ext = {}) {\n  return outer(combineReducers({ routing, user, chat, chats, users, outer, messages, ...ext }))\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Auth\":\"Auth_Auth__2lPSo\"};"],"sourceRoot":""}